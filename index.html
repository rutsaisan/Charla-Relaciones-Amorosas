<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vibe Check - El Semáforo de las Relaciones</title>
    
    <!-- Tailwind CSS (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons (CDN) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Configuración personalizada (Estética V1 + Animaciones del Juego) -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['ui-sans-serif', 'system-ui', 'sans-serif'], // Fuente original V1
                    },
                    animation: {
                        blob: "blob 7s infinite",
                        "fade-in-up": "fadeInUp 0.5s ease-out",
                        "shake": "shake 0.5s cubic-bezier(.36,.07,.19,.97) both" // Necesario para el juego
                    },
                    keyframes: {
                        blob: {
                            "0%": { transform: "translate(0px, 0px) scale(1)" },
                            "33%": { transform: "translate(30px, -50px) scale(1.1)" },
                            "66%": { transform: "translate(-20px, 20px) scale(0.9)" },
                            "100%": { transform: "translate(0px, 0px) scale(1)" }
                        },
                        fadeInUp: {
                            "0%": { opacity: "0", transform: "translateY(20px)" },
                            "100%": { opacity: "1", transform: "translateY(0)" }
                        },
                        shake: { // Animación de error del juego
                            "10%, 90%": { transform: "translate3d(-1px, 0, 0)" },
                            "20%, 80%": { transform: "translate3d(2px, 0, 0)" },
                            "30%, 50%, 70%": { transform: "translate3d(-4px, 0, 0)" },
                            "40%, 60%": { transform: "translate3d(4px, 0, 0)" }
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Estilos base V1 */
        body {
            background-color: #FDFCF8;
            color: #292524;
        }
        
        .slide {
            transition: all 500ms ease-in-out;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            overflow-y: auto;
        }

        @media (min-width: 768px) {
            .slide { padding: 3rem; }
        }

        .slide.active {
            opacity: 1;
            transform: translateX(0);
            pointer-events: auto;
        }

        .slide.inactive {
            opacity: 0;
            transform: translateX(2.5rem);
            pointer-events: none;
        }

        .animation-delay-2000 { animation-delay: 2s; }
        .animation-delay-4000 { animation-delay: 4s; }

        /* ESTILOS NECESARIOS PARA EL JUEGO */
        .correct-answer {
            background-color: #dcfce7 !important;
            border-color: #22c55e !important;
            color: #14532d !important;
        }

        .wrong-answer {
            background-color: #fee2e2 !important;
            border-color: #ef4444 !important;
            animation: shake 0.5s;
        }
    </style>
</head>
<body class="w-full h-screen font-sans selection:bg-rose-200 overflow-hidden relative">

    <!-- Fondo V1 -->
    <div class="absolute top-[-10%] right-[-5%] w-96 h-96 bg-purple-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob"></div>
    <div class="absolute bottom-[-10%] left-[-5%] w-96 h-96 bg-rose-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-2000"></div>
    <div class="absolute top-[40%] left-[30%] w-96 h-96 bg-amber-100 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-4000"></div>

    <div class="relative z-10 w-full h-full max-w-6xl mx-auto">

        <!-- SLIDE 0: INTRO -->
        <div class="slide active" id="slide-0">
            <div class="text-center space-y-6 animate-fade-in-up">
                <span class="inline-block px-4 py-1 rounded-full bg-stone-900 text-white text-xs font-bold tracking-widest uppercase mb-4">
                    Charla para el Clan
                </span>
                <h1 class="text-6xl md:text-8xl font-black tracking-tighter text-stone-900 mb-2">
                    VIBE CHECK
                </h1>
                <p class="text-2xl md:text-3xl font-light text-stone-600 italic">
                    El Semáforo de las Relaciones
                </p>
                <div class="w-24 h-1 bg-gradient-to-r from-red-400 via-amber-400 to-emerald-400 mx-auto rounded-full mt-8"></div>
                <p class="max-w-xl mx-auto mt-8 text-stone-500">
                    ¿Amor de película o peli de terror? Vamos a aprender a leer el tablero de control de vuestra vida amorosa.
                </p>
                <button onclick="nextSlide()" class="mt-12 px-8 py-3 bg-stone-900 text-white rounded-full hover:bg-stone-700 transition-colors flex items-center gap-2 mx-auto cursor-pointer">
                    Empezar <i data-lucide="arrow-right" width="18"></i>
                </button>
            </div>
        </div>

        <!-- SLIDE 1: INTRO FLAGS -->
        <div class="slide inactive" id="slide-1">
            <div class="max-w-4xl w-full">
                <h2 class="text-4xl font-bold mb-8 text-center">¿Qué son las "Flags"?</h2>
                <div class="grid md:grid-cols-3 gap-6">
                    <div class="bg-white p-8 rounded-3xl shadow-xl shadow-red-100 border border-red-100 flex flex-col items-center text-center">
                        <div class="p-4 bg-red-100 rounded-full mb-6 text-red-600"><i data-lucide="siren" width="32" height="32"></i></div>
                        <h3 class="text-xl font-bold mb-2">Red Flags</h3>
                        <p class="text-stone-500 text-sm">Señales de alerta inminente. Huir.</p>
                    </div>
                    <div class="bg-white p-8 rounded-3xl shadow-xl shadow-amber-100 border border-amber-100 flex flex-col items-center text-center">
                        <div class="p-4 bg-amber-100 rounded-full mb-6 text-amber-600"><i data-lucide="alert-triangle" width="32" height="32"></i></div>
                        <h3 class="text-xl font-bold mb-2">Yellow Flags</h3>
                        <p class="text-stone-500 text-sm">Comportamientos ambiguos. Precaución.</p>
                    </div>
                    <div class="bg-white p-8 rounded-3xl shadow-xl shadow-emerald-100 border border-emerald-100 flex flex-col items-center text-center">
                        <div class="p-4 bg-emerald-100 rounded-full mb-6 text-emerald-600"><i data-lucide="shield-check" width="32" height="32"></i></div>
                        <h3 class="text-xl font-bold mb-2">Green Flags</h3>
                        <p class="text-stone-500 text-sm">Salud emocional y respeto. Valorar.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- SLIDE 2: RED FLAGS -->
        <div class="slide inactive" id="slide-2">
            <div class="max-w-5xl w-full">
                <div class="flex items-center gap-4 mb-8">
                    <span class="bg-red-500 text-white p-3 rounded-xl"><i data-lucide="siren" width="24"></i></span>
                    <h2 class="text-4xl font-bold text-red-500">RED FLAGS</h2>
                </div>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <div class="p-6 rounded-2xl border-2 bg-red-50 border-red-200 text-red-800 hover:scale-105 transition-transform">
                        <div class="flex items-center gap-3 mb-3"><i data-lucide="message-circle" class="text-red-500"></i><h3 class="font-bold text-lg">Gaslighting</h3></div>
                        <p class="text-sm">Te hacen dudar de tu realidad: 'Eso no pasó', 'Estás loca/o'.</p>
                    </div>
                    <div class="p-6 rounded-2xl border-2 bg-red-50 border-red-200 text-red-800 hover:scale-105 transition-transform">
                        <div class="flex items-center gap-3 mb-3"><i data-lucide="users" class="text-red-500"></i><h3 class="font-bold text-lg">Aislamiento</h3></div>
                        <p class="text-sm">Te aleja de tus amigos y familia sutilmente.</p>
                    </div>
                    <div class="p-6 rounded-2xl border-2 bg-red-50 border-red-200 text-red-800 hover:scale-105 transition-transform">
                        <div class="flex items-center gap-3 mb-3"><i data-lucide="eye" class="text-red-500"></i><h3 class="font-bold text-lg">Control</h3></div>
                        <p class="text-sm">Ubicación, contraseñas, ropa. Celos disfrazados de amor.</p>
                    </div>
                    <div class="p-6 rounded-2xl border-2 bg-red-50 border-red-200 text-red-800 hover:scale-105 transition-transform">
                        <div class="flex items-center gap-3 mb-3"><i data-lucide="skull" class="text-red-500"></i><h3 class="font-bold text-lg">Ley del Hielo</h3></div>
                        <p class="text-sm">Castigo con silencio e indiferencia.</p>
                    </div>
                    <div class="p-6 rounded-2xl border-2 bg-red-50 border-red-200 text-red-800 hover:scale-105 transition-transform">
                        <div class="flex items-center gap-3 mb-3"><i data-lucide="alert-triangle" class="text-red-500"></i><h3 class="font-bold text-lg">No es No</h3></div>
                        <p class="text-sm">Cualquier presión tras un NO es violencia.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- SLIDE 3: YELLOW FLAGS -->
        <div class="slide inactive" id="slide-3">
            <div class="max-w-5xl w-full">
                <div class="flex items-center gap-4 mb-8">
                    <span class="bg-amber-400 text-white p-3 rounded-xl"><i data-lucide="alert-triangle" width="24"></i></span>
                    <h2 class="text-4xl font-bold text-amber-500">YELLOW FLAGS</h2>
                </div>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="p-6 rounded-2xl border-2 bg-amber-50 border-amber-200 text-amber-800 hover:scale-105 transition-transform">
                        <div class="flex items-center gap-3 mb-3"><i data-lucide="heart" class="text-amber-500"></i><h3 class="font-bold text-lg">Love Bombing</h3></div>
                        <p class="text-sm">'Te amo' a los dos días. Demasiado intenso demasiado pronto.</p>
                    </div>
                    <div class="p-6 rounded-2xl border-2 bg-amber-50 border-amber-200 text-amber-800 hover:scale-105 transition-transform">
                        <div class="flex items-center gap-3 mb-3"><i data-lucide="users" class="text-amber-500"></i><h3 class="font-bold text-lg">Ex 'Locos'</h3></div>
                        <p class="text-sm">Si todos sus ex estaban locos, el problema es él/ella.</p>
                    </div>
                    <div class="p-6 rounded-2xl border-2 bg-amber-50 border-amber-200 text-amber-800 hover:scale-105 transition-transform">
                        <div class="flex items-center gap-3 mb-3"><i data-lucide="battery-warning" class="text-amber-500"></i><h3 class="font-bold text-lg">Inconsistencia</h3></div>
                        <p class="text-sm">Hoy sí, mañana no. Breadcrumbing.</p>
                    </div>
                    <div class="p-6 rounded-2xl border-2 bg-amber-50 border-amber-200 text-amber-800 hover:scale-105 transition-transform">
                        <div class="flex items-center gap-3 mb-3"><i data-lucide="help-circle" class="text-amber-500"></i><h3 class="font-bold text-lg">Situationship</h3></div>
                        <p class="text-sm">Beneficios de pareja sin la responsabilidad del compromiso.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- SLIDE 4: GREEN FLAGS -->
        <div class="slide inactive" id="slide-4">
            <div class="max-w-5xl w-full">
                <div class="flex items-center gap-4 mb-8">
                    <span class="bg-emerald-500 text-white p-3 rounded-xl"><i data-lucide="shield-check" width="24"></i></span>
                    <h2 class="text-4xl font-bold text-emerald-600">GREEN FLAGS</h2>
                </div>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="p-6 rounded-2xl border-2 bg-emerald-50 border-emerald-200 text-emerald-800 hover:scale-105 transition-transform">
                        <div class="flex items-center gap-3 mb-3"><i data-lucide="sparkles" class="text-emerald-500"></i><h3 class="font-bold text-lg">Responsabilidad</h3></div>
                        <p class="text-sm">Cero ghosting. Sus acciones coinciden con sus palabras.</p>
                    </div>
                    <div class="p-6 rounded-2xl border-2 bg-emerald-50 border-emerald-200 text-emerald-800 hover:scale-105 transition-transform">
                        <div class="flex items-center gap-3 mb-3"><i data-lucide="battery-charging" class="text-emerald-500"></i><h3 class="font-bold text-lg">Te suma</h3></div>
                        <p class="text-sm">Sientes paz y energía después de verle, no ansiedad.</p>
                    </div>
                    <div class="p-6 rounded-2xl border-2 bg-emerald-50 border-emerald-200 text-emerald-800 hover:scale-105 transition-transform">
                        <div class="flex items-center gap-3 mb-3"><i data-lucide="user-check" class="text-emerald-500"></i><h3 class="font-bold text-lg">Individualidad</h3></div>
                        <p class="text-sm">Respeta tu tiempo, tus amigos y tus hobbies.</p>
                    </div>
                    <div class="p-6 rounded-2xl border-2 bg-emerald-50 border-emerald-200 text-emerald-800 hover:scale-105 transition-transform">
                        <div class="flex items-center gap-3 mb-3"><i data-lucide="message-circle" class="text-emerald-500"></i><h3 class="font-bold text-lg">Diálogo</h3></div>
                        <p class="text-sm">Se puede discutir para solucionar, no para ganar.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- SLIDE 5: COMPARATIVA -->
        <div class="slide inactive" id="slide-5">
            <div class="max-w-6xl w-full">
                <h2 class="text-4xl font-bold text-center mb-8">La Comparativa</h2>
                <div class="grid md:grid-cols-2 gap-0 rounded-3xl overflow-hidden shadow-2xl">
                    <div class="bg-stone-900 text-stone-300 p-8 md:p-12">
                        <div class="flex items-center gap-3 mb-6"><i data-lucide="skull" class="text-red-500"></i><h3 class="text-2xl font-bold text-white">Tóxica</h3></div>
                        <ul class="space-y-4">
                            <li><span class="text-red-500 font-bold">Energía:</span> Te drena.</li>
                            <li><span class="text-red-500 font-bold">Control:</span> Te quiere cambiar.</li>
                            <li><span class="text-red-500 font-bold">Verdad:</span> Miedo a su reacción.</li>
                        </ul>
                    </div>
                    <div class="bg-white text-stone-600 p-8 md:p-12">
                        <div class="flex items-center gap-3 mb-6"><i data-lucide="heart" class="text-emerald-500"></i><h3 class="text-2xl font-bold text-stone-900">Sana</h3></div>
                        <ul class="space-y-4">
                            <li><span class="text-emerald-500 font-bold">Energía:</span> Te da paz.</li>
                            <li><span class="text-emerald-500 font-bold">Libertad:</span> Confianza ciega.</li>
                            <li><span class="text-emerald-500 font-bold">Verdad:</span> Transparencia.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- SLIDE 6: DICCIONARIO -->
        <div class="slide inactive" id="slide-6">
            <div class="max-w-4xl w-full">
                <h2 class="text-4xl font-bold mb-10 text-center">Diccionario Moderno</h2>
                <div class="space-y-6">
                    <div class="bg-purple-50 p-6 rounded-2xl border-l-4 border-purple-500">
                        <h3 class="text-xl font-bold text-purple-900 mb-2">Responsabilidad Afectiva</h3>
                        <p class="text-purple-800">Hacerse cargo de que nuestros vínculos afectan a los demás. Honestidad.</p>
                    </div>
                    <div class="bg-white p-6 rounded-2xl border-l-4 border-stone-800 shadow-sm">
                        <h3 class="text-xl font-bold text-stone-900 mb-2">Consentimiento Entusiasta</h3>
                        <p class="text-stone-600">Un <span class="font-bold text-emerald-600">SÍ</span> activo y con ganas.</p>
                    </div>
                    <div class="bg-rose-50 p-6 rounded-2xl border-l-4 border-rose-400">
                        <h3 class="text-xl font-bold text-rose-900 mb-2">Mito de la Media Naranja</h3>
                        <p class="text-rose-800">Sois naranjas enteras. Nadie te completa, te acompañan.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- SLIDE 7: EL JUEGO (NUEVO, ADAPTADO A ESTÉTICA V1) -->
        <div class="slide inactive" id="slide-7">
            <div class="max-w-4xl w-full flex flex-col items-center">
                
                <!-- Intro del Juego -->
                <div id="game-intro" class="text-center w-full">
                    <div class="p-6 bg-stone-100 rounded-full inline-block mb-6">
                        <i data-lucide="gamepad-2" width="48" height="48" class="text-stone-800"></i>
                    </div>
                    <h2 class="text-4xl font-bold mb-4">Minijuego: Flag Sorter</h2>
                    <p class="text-xl text-stone-600 mb-8">Te daré una situación. Tú decides el color de la bandera.</p>
                    <button onclick="startGame()" class="px-8 py-3 bg-stone-900 text-white rounded-full hover:bg-stone-700 transition-transform hover:scale-105 font-bold shadow-lg">
                        JUGAR
                    </button>
                </div>

                <!-- Gameplay -->
                <div id="game-play" class="hidden w-full max-w-2xl">
                    <div class="flex justify-between items-center mb-6">
                        <span class="text-stone-500 font-mono">Pregunta <span id="q-current">1</span>/<span id="q-total">5</span></span>
                        <span class="font-bold text-stone-800 bg-stone-200 px-4 py-1 rounded-full">Puntos: <span id="score">0</span></span>
                    </div>

                    <!-- Tarjeta de Pregunta (Estilo V1) -->
                    <div id="question-card" class="w-full bg-white border-4 border-stone-200 rounded-3xl p-10 shadow-lg mb-8 text-center min-h-[200px] flex items-center justify-center transition-all duration-300">
                        <p id="question-text" class="text-2xl font-bold text-stone-800">Cargando...</p>
                    </div>
                    
                    <div id="feedback-area" class="h-8 mb-6 text-center font-bold text-lg transition-opacity duration-300 opacity-0"></div>

                    <!-- Botones de Respuesta -->
                    <div class="grid grid-cols-3 gap-4" id="game-controls">
                        <button onclick="checkAnswer('red')" class="p-4 rounded-xl bg-red-100 text-red-700 hover:bg-red-500 hover:text-white transition-colors flex flex-col items-center gap-2 border-2 border-red-200 font-bold">
                            <i data-lucide="siren"></i> RED
                        </button>
                        <button onclick="checkAnswer('yellow')" class="p-4 rounded-xl bg-amber-100 text-amber-700 hover:bg-amber-500 hover:text-white transition-colors flex flex-col items-center gap-2 border-2 border-amber-200 font-bold">
                            <i data-lucide="alert-triangle"></i> YELLOW
                        </button>
                        <button onclick="checkAnswer('green')" class="p-4 rounded-xl bg-emerald-100 text-emerald-700 hover:bg-emerald-500 hover:text-white transition-colors flex flex-col items-center gap-2 border-2 border-emerald-200 font-bold">
                            <i data-lucide="shield-check"></i> GREEN
                        </button>
                    </div>
                    
                    <button id="next-q-btn" onclick="nextQuestion()" class="hidden w-full mt-4 py-4 bg-stone-900 text-white rounded-xl font-bold hover:bg-stone-800 transition-colors">
                        Siguiente
                    </button>
                </div>

                <!-- Resultado -->
                <div id="game-result" class="hidden text-center w-full">
                    <h2 class="text-3xl font-bold mb-6">Resultado</h2>
                    <div class="text-8xl font-black text-stone-900 mb-6" id="final-score">0</div>
                    <p class="text-xl text-stone-600 mb-10" id="final-message">Mensaje</p>
                    <div class="flex gap-4 justify-center">
                        <button onclick="resetGame()" class="px-6 py-3 bg-stone-200 text-stone-900 rounded-full hover:bg-stone-300 transition-colors font-bold">Reintentar</button>
                        <button onclick="nextSlide()" class="px-6 py-3 bg-stone-900 text-white rounded-full hover:bg-stone-700 transition-colors font-bold">Conclusión</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- SLIDE 8: ENDING -->
        <div class="slide inactive" id="slide-8">
            <div class="text-center space-y-8 animate-fade-in-up max-w-2xl">
                <div class="inline-block p-6 rounded-full bg-stone-100 mb-4">
                    <i data-lucide="sparkles" width="48" height="48" class="text-stone-800"></i>
                </div>
                <h2 class="text-5xl font-black text-stone-900">
                    No sois centros de rehabilitación.
                </h2>
                <p class="text-2xl text-stone-600 leading-relaxed">
                    Vuestra intuición suele tener razón. Buscad a alguien que os haga sentir que el amor es fácil, bonito y seguro.
                </p>
                <div class="pt-8">
                    <button onclick="goToSlide(0)" class="px-6 py-2 bg-stone-900 text-white rounded-full hover:scale-105 transition-transform cursor-pointer">Reiniciar</button>
                </div>
            </div>
        </div>

        <!-- CONTROLS -->
        <div class="absolute bottom-8 left-0 w-full flex justify-between px-8 md:px-12 items-center text-stone-400 z-50">
            <span class="font-mono text-sm" id="slide-counter">1 / 9</span>
            <div class="flex gap-4">
                <button id="prev-btn" onclick="prevSlide()" class="p-3 rounded-full hover:bg-stone-200 transition-colors text-stone-800 disabled:opacity-30 disabled:cursor-not-allowed cursor-pointer" disabled>
                    <i data-lucide="arrow-left" width="24"></i>
                </button>
                <button id="next-btn" onclick="nextSlide()" class="p-3 rounded-full hover:bg-stone-200 transition-colors text-stone-800 disabled:opacity-30 disabled:cursor-not-allowed cursor-pointer">
                    <i data-lucide="arrow-right" width="24"></i>
                </button>
            </div>
        </div>

    </div>

    <!-- JavaScript Logic -->
    <script>
        lucide.createIcons();

        // NAVEGACIÓN
        let currentSlide = 0;
        const totalSlides = 9; // Aumentado a 9 por el juego
        const slides = document.querySelectorAll('.slide');
        const slideCounter = document.getElementById('slide-counter');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');

        function updateView() {
            slides.forEach((slide, index) => {
                if (index === currentSlide) {
                    slide.classList.remove('inactive');
                    slide.classList.add('active');
                } else {
                    slide.classList.remove('active');
                    slide.classList.add('inactive');
                }
            });
            slideCounter.textContent = `${currentSlide + 1} / ${totalSlides}`;
            prevBtn.disabled = currentSlide === 0;
            nextBtn.disabled = currentSlide === totalSlides - 1;
        }

        function nextSlide() { if (currentSlide < totalSlides - 1) { currentSlide++; updateView(); } }
        function prevSlide() { if (currentSlide > 0) { currentSlide--; updateView(); } }
        function goToSlide(index) { currentSlide = index; updateView(); }

        window.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight') nextSlide();
            if (e.key === 'ArrowLeft') prevSlide();
        });

        // LÓGICA DEL JUEGO
        const questions = [
            { text: "Revisa tu móvil a escondidas.", type: "red", feedback: "Privacidad violada = Red Flag." },
            { text: "Propone planes teniendo en cuenta tus gustos.", type: "green", feedback: "Interés genuino." },
            { text: "Dice 'estás loca' cuando te quejas.", type: "red", feedback: "Gaslighting puro." },
            { text: "Habla mucho de su ex.", type: "yellow", feedback: "Ojo, puede no haber superado el pasado." },
            { text: "Te anima a salir con tus amigos.", type: "green", feedback: "Confianza y respeto." },
            { text: "'Te amo' en la segunda cita.", type: "yellow", feedback: "Love Bombing. Cuidado." },
            { text: "Te pregunta cómo te sientes.", type: "green", feedback: "Responsabilidad afectiva." },
            { text: "Te culpa de sus errores.", type: "red", feedback: "Manipulación." }
        ];

        let gameScore = 0;
        let qIndex = 0;
        let isAnswering = false;

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function startGame() {
            shuffleArray(questions);
            gameScore = 0;
            qIndex = 0;
            isAnswering = false;
            
            document.getElementById('game-intro').classList.add('hidden');
            document.getElementById('game-result').classList.add('hidden');
            document.getElementById('game-play').classList.remove('hidden');
            
            document.getElementById('q-total').textContent = questions.length;
            updateQuestionUI();
        }

        function updateQuestionUI() {
            document.getElementById('q-current').textContent = qIndex + 1;
            document.getElementById('score').textContent = gameScore;
            
            const card = document.getElementById('question-card');
            card.className = "w-full bg-white border-4 border-stone-200 rounded-3xl p-10 shadow-lg mb-8 text-center min-h-[200px] flex items-center justify-center transition-all duration-300";
            document.getElementById('question-text').textContent = questions[qIndex].text;
            
            const feedback = document.getElementById('feedback-area');
            feedback.style.opacity = '0';
            feedback.textContent = '';
            
            document.getElementById('game-controls').classList.remove('hidden');
            document.getElementById('next-q-btn').classList.add('hidden');
            isAnswering = true;
        }

        function checkAnswer(selectedType) {
            if (!isAnswering) return;
            isAnswering = false;

            const currentQ = questions[qIndex];
            const card = document.getElementById('question-card');
            const feedback = document.getElementById('feedback-area');

            if (selectedType === currentQ.type) {
                gameScore += 100;
                card.classList.add('correct-answer');
                feedback.innerHTML = `<span class="text-emerald-600 flex items-center justify-center gap-2"><i data-lucide="check-circle"></i> ¡Correcto! ${currentQ.feedback}</span>`;
            } else {
                card.classList.add('wrong-answer');
                feedback.innerHTML = `<span class="text-red-500 flex items-center justify-center gap-2"><i data-lucide="x-circle"></i> Incorrecto. ${currentQ.feedback}</span>`;
            }
            lucide.createIcons();
            document.getElementById('score').textContent = gameScore;
            feedback.style.opacity = '1';

            document.getElementById('game-controls').classList.add('hidden');
            document.getElementById('next-q-btn').classList.remove('hidden');
        }

        function nextQuestion() {
            qIndex++;
            if (qIndex < questions.length) { updateQuestionUI(); } else { endGame(); }
        }

        function endGame() {
            document.getElementById('game-play').classList.add('hidden');
            document.getElementById('game-result').classList.remove('hidden');
            document.getElementById('final-score').textContent = gameScore;
            
            const percentage = gameScore / (questions.length * 100);
            const msg = percentage === 1 ? "¡Radar infalible!" : (percentage >= 0.7 ? "¡Muy buena intuición!" : "Sigue practicando.");
            document.getElementById('final-message').textContent = msg;
        }

        function resetGame() { startGame(); }
        updateView();
    </script>
</body>
</html>